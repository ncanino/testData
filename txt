Dipendenze pom:
		<!-- EHCache Core API -->
		<dependency>
		    <groupId>net.sf.ehcache</groupId>
		    <artifactId>ehcache-core</artifactId>
		    <version>2.4.5</version>
		</dependency>
		<!-- Hibernate EHCache API -->
		<dependency>
			<groupId>org.hibernate</groupId>
			<artifactId>hibernate-ehcache</artifactId>
			<version>5.1.1.Final</version>
		</dependency>

Configurazione sessionFactory e hibernate properties:

<bean id="ES.SessionFactory" class="org.springframework.orm.hibernate5.LocalSessionFactoryBean">
		<property name="dataSource" ref="ES.dataSourceSMSA2" />
		<property name="mappingResources">
			<list>
				<value>test.hbm.xml</value>
			</list>
		</property>
		
		<property name="hibernateProperties">
			<props>
				<prop key="proxy-target-class">true</prop>
				<!-- <prop key="current_session_context_class">thread</prop> -->
				<prop key="hibernate.dialect">org.hibernate.dialect.Oracle10gDialect</prop>
				<prop key="hibernate.show_sql">false</prop>
				<prop key="hibernate.format_sql">false</prop>

				<prop key="hibernate.cache.use_query_cache">true</prop>
				<prop key="hibernate.cache.use_second_level_cache">true</prop>
				
				<prop key="hibernate.cache.provider_configuration_file_resource_path">classpath:ehcache.xml</prop> 
				<prop key="hibernate.cache.region.factory_class">org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory</prop>
				<prop key="hibernate.cache.use_structured_entries">true</prop> 
				<prop key="hibernate.generate_statistics">false</prop>

			</props>
		</property>
	</bean>		

La configurazione ehcache.xml è la seguente:

<?xml version="1.0" encoding="UTF-8"?>
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"	
			 xsi:noNamespaceSchemaLocation="ehcache.xsd">

    <defaultCache
        maxElementsInMemory="2000"
        eternal="false"
        timeToIdleSeconds="49766400"
        timeToLiveSeconds="49766400"
        overflowToDisk="false"
        diskPersistent="false"
        diskExpiryThreadIntervalSeconds="120" 
        />

    <cache name="org.hibernate.cache.StandardQueryCache"
		eternal="false"
		maxElementsInMemory="2000"
		timeToLiveSeconds="49766400" >
    </cache>
    
	<cache name="org.hibernate.cache.UpdateTimestampsCache"
		eternal="true"  >
	</cache>

	<cache
	    name="com.bnpp.external.services.dao.beo.ProductType"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
	    	<searchAttribute name="code" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="idproducttype" expression="key.getIdproducttype()"/>
	    </searchable>
    </cache>
    	
	<cache
	    name="com.bnpp.external.services.dao.beo.Product"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
	    	<searchAttribute name="code" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="idproduct" expression="key.getIdproduct()"/>
	    	<searchAttribute name="idproducttype" class="com.bnpp.external.services.business.util.Value" />
	    </searchable>
    </cache>
    
	<cache
	    name="com.bnpp.external.services.dao.beo.Subproduct"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
	    	<searchAttribute name="code" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="idsubproduct" expression="key.getIdSubproduct()"/>
	    	<searchAttribute name="product" class="com.bnpp.external.services.business.util.Value" />
	    </searchable>
    </cache>
    
	<cache
	    name="com.bnpp.external.services.dao.beo.Event"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
	    	<searchAttribute name="code" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="subproduct" class="com.bnpp.external.services.business.util.Value"/>
	    	<searchAttribute name="idevent" expression="key.getIdevent()"/>
	    </searchable>
    </cache>
    
	<cache
	    name="com.bnpp.external.services.dao.beo.Handler"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
	    	<searchAttribute name="description" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="idhandler" expression="key.getIdhandler()"/>
	    </searchable>
    </cache>
    
	<cache
	    name="com.bnpp.external.services.dao.beo.Corporate"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
	    	<searchAttribute name="code" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="idCorporate" expression="key.getIdCorporate()"/>
	    </searchable>
    </cache>
    
	<cache
	    name="com.bnpp.external.services.dao.beo.XMLTemplate"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
 	    	<searchAttribute name="idSubCom" expression="key.getKey().getIdSubCom()" />
	    	<searchAttribute name="product" expression="key.getKey().getProduct()" />
	    	<searchAttribute name="subproduct" expression="key.getKey().getSubproduct()" />
	    	<searchAttribute name="event" expression="key.getKey().getEvent()" />
	    	<searchAttribute name="handler" expression="key.getKey().getHandler()" />
	    	<searchAttribute name="corporate" expression="key.getKey().getCorporate()"  />
	    </searchable>
    </cache>
    
  	<cache
	    name="com.bnpp.external.services.dao.beo.Applicationstoprodsubprod"
	    eternal="false"
	    timeToIdleSeconds="49766400"
	    timeToLiveSeconds="49766400"
		diskPersistent="false">
	    <searchable keys="true" values="true">
 	    	<searchAttribute name="id" expression="key.getId()" />
	    	<searchAttribute name="product" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="subproduct" class="com.bnpp.external.services.business.util.Value" />
	    	<searchAttribute name="codeapp" class="com.bnpp.external.services.business.util.Value" />
	    </searchable>
    </cache>
    
    <cache
	name="com.bnpp.external.services.dao.beo.SmsAlertConfiguration"
	eternal="false"
	timeToIdleSeconds="49766400"
	timeToLiveSeconds="49766400"
	diskPersistent="false">
	   <searchable keys="true" values="true">
 	  	<searchAttribute name="configId" expression="key.getConfigId()" />
	   	<searchAttribute name="configKey" class="com.bnpp.external.services.business.util.Value" />
	   	<searchAttribute name="configValue" class="com.bnpp.external.services.business.util.Value" />
	   	<searchAttribute name="configUpdTimestamp" class="com.bnpp.external.services.business.util.Value" />
	  </searchable>
    </cache>
</ehcache>

OTTENGO I SEGUENTE ERRORE IN FASE DI START DELL'APPLICAZIONE:

Caused by: net.sf.ehcache.config.InvalidConfigurationException: There are 10 errors in your configuration: 
	* Cache 'com.bnpp.external.services.dao.beo.Subproduct' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.Event' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'org.hibernate.cache.UpdateTimestampsCache' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.ProductType' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.XMLTemplate' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.Corporate' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.Handler' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.Applicationstoprodsubprod' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.Product' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	* Cache 'com.bnpp.external.services.dao.beo.SmsAlertConfiguration' error: If your CacheManager has no maxBytesLocalHeap set, you need to either set maxEntriesLocalHeap or maxBytesLocalHeap at the Cache level
	
IDICAMI PRECISAMENTE COME RISOLVERE CERCANDO DI NON COMMETTERE ERRORI


L'errore che stai riscontrando indica che ci sono problemi nella configurazione del file ehcache.xml, in particolare per le cache specificate. L'errore specifico è relativo alla mancata impostazione di "maxEntriesLocalHeap" o "maxBytesLocalHeap" per ciascuna cache nel caso in cui il "CacheManager" non abbia un valore "maxBytesLocalHeap" impostato.

Per risolvere l'errore, devi aggiungere la configurazione appropriata per le cache nel file ehcache.xml. Ogni cache dovrebbe avere una delle seguenti proprietà impostate:

- `maxEntriesLocalHeap`: specifica il numero massimo di elementi che possono essere memorizzati in cache in memoria.
- `maxBytesLocalHeap`: specifica la dimensione massima della cache in memoria in byte.

Ecco un esempio di come puoi configurare correttamente una cache nel file ehcache.xml:

```xml
<cache name="com.bnpp.external.services.dao.beo.Subproduct"
       maxEntriesLocalHeap="1000"
       eternal="false"
       timeToIdleSeconds="49766400"
       timeToLiveSeconds="49766400"
       diskPersistent="false">
    <searchable keys="true" values="true">
        <searchAttribute name="code" class="com.bnpp.external.services.business.util.Value" />
        <searchAttribute name="idsubproduct" expression="key.getIdSubproduct()"/>
        <searchAttribute name="product" class="com.bnpp.external.services.business.util.Value" />
    </searchable>
</cache>
```

Assicurati di aggiornare la configurazione di tutte le cache elencate nell'errore con le appropriate proprietà `maxEntriesLocalHeap` o `maxBytesLocalHeap` specificate.

Ripeti lo stesso processo per tutte le altre cache elencate nell'errore. Assicurati di specificare un valore appropriato per `maxEntriesLocalHeap` o `maxBytesLocalHeap` in base alle tue esigenze.

Una volta corretta la configurazione del file ehcache.xml, dovresti essere in grado di avviare correttamente l'applicazione senza gli errori segnalati.

La differenza di comportamento tra Hibernate 3 e Hibernate 5 potrebbe essere dovuta a modifiche nella gestione della cache e nelle impostazioni di default.

In Hibernate 3, potrebbe essere stato utilizzato un'altra configurazione predefinita per la gestione della cache, che potrebbe non richiedere esplicitamente la configurazione di `maxEntriesLocalHeap` o `maxBytesLocalHeap` per le cache.

Tuttavia, in Hibernate 5 potrebbe essere stata introdotta una nuova configurazione predefinita o un cambiamento nel modo in cui la cache viene gestita, richiedendo l'aggiunta esplicita di tali proprietà per le cache definite nel file ehcache.xml.

Le modifiche nelle versioni successive di un framework o una libreria possono comportare cambiamenti nelle configurazioni o nei requisiti di configurazione. Pertanto, è importante adattare la configurazione alle nuove versioni per garantire il corretto funzionamento dell'applicazione.

Nel tuo caso, poiché stai migrando da Hibernate 3 a Hibernate 5, potrebbero esserci differenze nella configurazione della cache che richiedono modifiche nel file ehcache.xml.

Raccomando di fare riferimento alla documentazione di Hibernate 5 e alle guide di migrazione ufficiali per verificare le modifiche necessarie nella configurazione della cache e adattare di conseguenza il tuo file ehcache.xml. In questo modo, sarai sicuro di utilizzare una configurazione corretta e aggiornata per Hibernate 5.
	

