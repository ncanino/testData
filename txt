W com.ibm.ws.ecs.internal.scan.context.impl.ScannerContextImpl scanJAR unable to open input stream for resource module-info.class in archive WEB-INF/lib/jaxb-runtime-2.3.1.jar
                                 java.lang.IllegalArgumentException

Caused by: org.hibernate.service.spi.ServiceException: Unable to create requested service [org.hibernate.cache.spi.RegionFactory]
Caused by: org.hibernate.boot.registry.selector.spi.StrategySelectionException: Unable to resolve name [net.sf.ehcache.hibernate.SingletonEhCacheRegionFactory] as strategy [org.hibernate.cache.spi.RegionFactory]

Ho migrato da Hibernate 3 ad hibernate 5.1.1 ed il bean che configura il session factory è il seguente:

<bean id="ES.SessionFactory" class="org.springframework.orm.hibernate5.LocalSessionFactoryBean">
    
		<property name="dataSource" ref="ES.dataSourceSMSA2" />
		<property name="mappingResources">
			<list>
				<value>test.hbm.xml</value>
			</list>
		</property>
		
		<property name="hibernateProperties">
			<props>
				<prop key="proxy-target-class">true</prop>
				<!-- <prop key="current_session_context_class">thread</prop> -->
				<prop key="hibernate.dialect">org.hibernate.dialect.Oracle10gDialect</prop>
				<prop key="hibernate.show_sql">false</prop>
				<prop key="hibernate.format_sql">false</prop>

				<prop key="hibernate.cache.use_query_cache">true</prop>
				<prop key="hibernate.cache.use_second_level_cache">true</prop>
				<!-- prop key="hibernate.cache.provider_class">net.sf.ehcache.hibernate.EhCacheProvider</prop -->
				<prop key="hibernate.cache.provider_configuration_file_resource_path">classpath:ehcache.xml</prop> 
				<prop key="hibernate.cache.region.factory_class">net.sf.ehcache.hibernate.SingletonEhCacheRegionFactory</prop>
				<prop key="hibernate.cache.use_structured_entries">true</prop> 
				<prop key="hibernate.generate_statistics">false</prop>

			</props>
		</property>
	</bean>		

la dipendenza attuale che prima della migrazione funzionava era 

<dependency>
<groupId>net.sf.ehcache</groupId>
<artifactId>ehcache-core</artifactId>
<version>2.4.5</version>
</dependency>

Come risolvo l'errore senza sconvolgere il codice?


L'errore che stai riscontrando indica che Hibernate non è in grado di risolvere la classe `net.sf.ehcache.hibernate.SingletonEhCacheRegionFactory` come factory per le regioni di cache. Questo è dovuto al fatto che la classe `SingletonEhCacheRegionFactory` non fa parte delle classi fornite da Hibernate 5.1.1.

Per risolvere il problema, puoi seguire i seguenti passaggi:

1. Assicurati di avere le dipendenze corrette per Hibernate e Ehcache nel tuo progetto. Per utilizzare Ehcache come provider di cache con Hibernate 5, dovresti includere le seguenti dipendenze nel tuo file `pom.xml` se stai utilizzando Maven:

```xml
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-core</artifactId>
    <version>5.1.1.Final</version>
</dependency>

<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-ehcache</artifactId>
    <version>5.1.1.Final</version>
</dependency>

<dependency>
    <groupId>org.ehcache</groupId>
    <artifactId>ehcache</artifactId>
    <version>3.8.1</version>
</dependency>
```

Assicurati che le versioni delle dipendenze siano coerenti con la versione di Hibernate 5.1.1 che stai utilizzando.

2. Nel tuo file di configurazione `ehcache.xml`, assicurati che la configurazione sia corretta per Ehcache 3.8.1.

3. Nel tuo file di configurazione Spring, aggiorna la proprietà `hibernate.cache.region.factory_class` nel bean `LocalSessionFactoryBean` come segue:

```xml
<prop key="hibernate.cache.region.factory_class">org.hibernate.cache.ehcache.internal.EhCacheRegionFactory</prop>
```

Questa classe è fornita da Hibernate 5 e sostituisce `SingletonEhCacheRegionFactory` utilizzata in Hibernate 3.

Assicurati di aver correttamente configurato le dipendenze, inclusa la versione corretta di Hibernate e Ehcache, e di aver aggiornato la classe della factory della regione di cache come indicato sopra.

Dopo aver apportato queste modifiche, dovresti essere in grado di avviare l'applicazione senza l'errore relativo alla creazione della factory di regione di cache.
